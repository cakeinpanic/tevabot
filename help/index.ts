import {filter} from 'rxjs/operators';
import {$commands, sendMessageToBot} from '../bot';
import {HELP, INLINE_CB} from '../groups/buttons';
import {filterByWord, isFromUser} from '../utils';


const helpText = `
ÐŸÑ€Ð¸Ð²ÐµÑ‚, Ñ Ð±Ð¾Ñ‚! Ð¯ Ñ‚ÑƒÑ‚, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑƒÐ»ÑƒÑ‡ÑˆÐ¸Ñ‚ÑŒ TevaPulse! ðŸ¿

ÐšÐ°Ðº Ð¼Ð¾Ð¶Ð½Ð¾ Ð¼ÐµÐ½Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ?
â–  Ð½Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð»ÑŽÐ±Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ, Ð¸ Ð¾Ð½Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ‚Ð¾Ñ€Ð°Ð¼. Ð­Ñ‚Ð¾ Ð¼Ð¾Ð¶Ð½Ð¾ (Ð¸ Ð½ÑƒÐ¶Ð½Ð¾) Ð´ÐµÐ»Ð°Ñ‚ÑŒ, ÐµÑÐ»Ð¸ Ñƒ Ñ‚ÐµÐ±Ñ ÐµÑÑ‚ÑŒ ÐºÐ°ÐºÐ¸Ðµ-Ñ‚Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¸Ð»Ð¸ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð¿Ð¾ÑˆÐ»Ð¾ Ð½Ðµ Ñ‚Ð°Ðº. ÐœÑ‹ ÑÑ€Ð°Ð·Ñƒ Ð¶Ðµ Ñ‚ÐµÐ±Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ð¼. ðŸ¸ 
â–  Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð²Ð¸Ð´ÐµÐ¾, Ñ„Ð¾Ñ‚Ð¾, Ð°ÑƒÐ´Ð¸Ð¾ Ð¸Ð»Ð¸ Ð´Ð°Ð¶Ðµ "ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº" Ð½Ð°Ð¼. Ð˜Ð· Ð¿Ñ€Ð¸ÑÐ»Ð°Ð½Ð½Ñ‹Ñ… Ð¼ÐµÐ´Ð¸Ð° Ð¼Ñ‹ Ð¿Ð¾Ñ‚Ð¾Ð¼ ÑÐ´ÐµÐ»Ð°ÐµÐ¼ ÐºÑ€ÑƒÑ‚Ð¾Ðµ ÑÐ»Ð°Ð¹Ð´ÑˆÐ¾Ñƒ. Ð˜ Ð²Ð¾Ð¾Ð±Ñ‰Ðµ Ð½Ð°Ð¼ Ð² ÑˆÑ‚Ð°Ð±Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾ Ð¿Ð¾ÑÐ¾Ð¼Ñ‚Ñ€ÐµÑ‚ÑŒ Ð½Ð° Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð²Ð¸Ð´Ð¸Ñ‚Ðµ Ð²Ñ‹ Ð² ÑÑ‚Ð¾Ð¼ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ð¸ ðŸŒ»
â–  ÑƒÐ·Ð½Ð°Ñ‚ÑŒ Ñ€Ð°Ð½Ð´Ð¾Ð¼Ð½Ñ‹Ð¹ Ñ„Ð°ÐºÑ‚ Ð¿Ñ€Ð¾ ÑÐ²Ð¾Ð¹ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚ Ñ‡ÐµÑ€ÐµÐ· Ð¼ÐµÐ½ÑŽ ðŸ’
 
Ð¢Ð°ÐºÐ¶Ðµ Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¼Ñ‹ ÑÐ°Ð¼Ð¸ Ð±ÑƒÐ´ÐµÐ¼ Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ñ‚ÑŒ Ñ‡ÐµÑ€ÐµÐ· Ð±Ð¾Ñ‚Ð° Ð²ÑÑÐºÐ¸Ðµ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ ÑˆÑ‚ÑƒÐºÐ¸, Ð·Ð°Ð´Ð°Ð½Ð¸Ñ Ð¸ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ. Ð§Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð½Ð¸ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ð»Ð¸ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾, Ð²Ð°Ð¶Ð½Ð¾ ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð·Ð´ÐµÑÑŒ ÑÐ²Ð¾Ð¹ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð¼Ð¾Ñ‰Ð¸ Ð¼ÐµÐ½ÑŽ Ð²Ð½Ð¸Ð·Ñƒ. Ð•ÑÐ»Ð¸ Ñ‚Ñ‹ Ð½Ðµ Ð·Ð½Ð°ÐµÑˆÑŒ ÑÐ²Ð¾Ð¹ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚ â€“ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ Ð½Ð° ÑÑ‚Ð¾ Ð±Ð¾Ñ‚Ñƒ, Ð¸ Ð¼Ñ‹ Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÐ¼! ðŸ• 
`

const $help = $commands.pipe(
    filter((msg) => isFromUser(msg)),
    filter(t => filterByWord(t, HELP))
);

$help.subscribe((from) => {
    sendAbout(from.from.id)
});

export function sendAbout(userId, prefix = '') {

    if (!!prefix) {
        sendMessageToBot(userId, prefix + helpText, INLINE_CB)
        return
    }
    sendMessageToBot(userId, helpText)
}

